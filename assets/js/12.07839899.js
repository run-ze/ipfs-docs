(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{375:function(e,t,a){e.exports=a.p+"assets/img/diagram-of-the-want-have-want-block-process.6ef862a2.png"},445:function(e,t,a){"use strict";a.r(t);var s=a(18),o=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"bitswap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bitswap"}},[e._v("#")]),e._v(" Bitswap")]),e._v(" "),s("p",[e._v("Bitswap is a core module of IPFS for exchanging blocks of data. It directs the requesting and sending of blocks to and from other peers in the network. Bitswap is a "),s("em",[e._v("message-based protocol")]),e._v(" where all messages contain "),s("a",{attrs:{href:"#want-list"}},[e._v("want-lists")]),e._v(" or blocks. Bitswap has a "),s("a",{attrs:{href:"https://github.com/ipfs/go-bitswap",target:"_blank",rel:"noopener noreferrer"}},[e._v("Go implementation"),s("OutboundLink")],1),e._v(" and a "),s("a",{attrs:{href:"https://github.com/ipfs/js-ipfs-bitswap",target:"_blank",rel:"noopener noreferrer"}},[e._v("JavaScript implementation"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Bitswap has two main jobs:")]),e._v(" "),s("ul",[s("li",[e._v("Acquire blocks requested by the client from the network.")]),e._v(" "),s("li",[e._v("Send blocks in its possession to other peers who want them.")])]),e._v(" "),s("h2",{attrs:{id:"how-bitswap-works"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-bitswap-works"}},[e._v("#")]),e._v(" How Bitswap works")]),e._v(" "),s("p",[e._v("IPFS breaks up files into chunks of data called "),s("em",[e._v("blocks")]),e._v(". These blocks are identified by a "),s("a",{attrs:{href:"/content/content-addressing"}},[e._v("content identifier (CID)")]),e._v(". When nodes running the Bitswap protocol want to fetch a file, they send out "),s("code",[e._v("want-lists")]),e._v(" to other peers. A "),s("code",[e._v("want-list")]),e._v(" is a list of CIDs for blocks a peer wants to receive. Each node remembers which blocks its peers want. Each time a node receives a block, it checks if any of its peers want the block, and sends it to them if they do.")]),e._v(" "),s("p",[e._v("Here is a simplifed version of a "),s("code",[e._v("want-list")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("Want"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("list "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  QmZtmD2qt6fJot32nabSP3CUjicnypEBz7bHVDhPQt9aAy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[e._v("WANT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  QmTudJSaoKxtbEnTddJ9vh8hbN84ZLVvD5pNpUaSbxwGoa"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[e._v("WANT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("...")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("h4",{attrs:{id:"discovery"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#discovery"}},[e._v("#")]),e._v(" Discovery")]),e._v(" "),s("p",[e._v("To find peers that have a file, a node running the Bitswap protocol first sends a request called a "),s("em",[e._v("want-have")]),e._v(" to all the peers it is connected to. This "),s("em",[e._v("want-have")]),e._v(" request contains the CID of the root block of the file (the root block is at the top of the DAG of blocks that make up the file). Peers that have the root block send a "),s("em",[e._v("have")]),e._v(" response, and are added to a session. Peers that don't have the block send a "),s("em",[e._v("dont-have")]),e._v(" response. If none of the peers have the root block, Bitswap queries the Distributed Hash Table (DHT) to ask who can provide the root block.")]),e._v(" "),s("p",[s("img",{attrs:{src:a(375),alt:"Diagram of the _want-have/want-block_ process.",width:"740",height:"537",loading:"lazy"}})]),e._v(" "),s("h4",{attrs:{id:"transfer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transfer"}},[e._v("#")]),e._v(" Transfer")]),e._v(" "),s("p",[e._v("Once peers have been added to a session, for each block that the client wants, Bitswap sends "),s("em",[e._v("want-have")]),e._v(" to each session peer to find out which peers have the block. Peers respond with "),s("em",[e._v("have")]),e._v(" or "),s("em",[e._v("dont_have")]),e._v(". Bitswap builds up a map of which nodes have and don't have each block. Bitswap sends "),s("em",[e._v("want-block")]),e._v(" to peers that have the block and they respond with the block itself. If no peers have the block Bitswap queries the DHT to find providers who have the block.")]),e._v(" "),s("h3",{attrs:{id:"additional-references"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#additional-references"}},[e._v("#")]),e._v(" Additional references")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.ipfs.io/2020-02-14-improved-bitswap-for-container-distribution/",target:"_blank",rel:"noopener noreferrer"}},[e._v("February 2020: New improvements to IPFS Bitswap"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://docs.google.com/presentation/d/1mbFFGIIKNvboHyLn-k26egOSWkt9nXjlNbxpmCEQfqQ/edit#slide=id.p",target:"_blank",rel:"noopener noreferrer"}},[e._v("Technical overview of the Go implementation of Bitswap"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://medium.com/textileio/swapping-bits-and-distributing-hashes-on-the-decentralized-web-5da98a3507",target:"_blank",rel:"noopener noreferrer"}},[e._v("Article: Swapping bits and distributing hashes on the decentralized web (Textile)"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v('"About Bitswap" Go implementation poster from the IPFS developer summit in Berlin in July 2018:'),s("br"),e._v(" "),s("img",{attrs:{src:"https://user-images.githubusercontent.com/74178/43230914-f818dab2-901e-11e8-876b-73ba6a084f76.jpg",alt:"'About Bitswap' poster",title:"Bitswap-Poster_Berlin-July-2018",loading:"lazy"}})])])])}),[],!1,null,null,null);t.default=o.exports}}]);