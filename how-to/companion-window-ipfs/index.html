<!doctype html><html lang="en-US"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using `window.ipfs` | IPFS Docs</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="preconnect" href="https://www.google-analytics.com">
    <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
    <link rel="manifest" href="../../manifest.json">
    <link rel="mask-icon" href="../../safari-pinned-tab.svg" color="#3a0839">
    <link rel="shortcut icon" href="../../favicon.ico"><link rel="canonical" href="https://ipfs.zh-cn.help/how-to/companion-window-ipfs/">
    <meta name="description" content="Learn about exposing IPFS API in IPFS Companion via " window.ipfs&#x22;.&#x22;="">
    <meta property="article:modified_time" content="2020-06-23T03:25:51.000Z">
    <meta property="og:title" content="Using window.ipfs">
    <meta property="og:description" content="Learn about exposing IPFS API in IPFS Companion via " window.ipfs&#x22;.&#x22;="">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ipfs.zh-cn.help/how-to/companion-window-ipfs/">
    <meta property="og:image" content="https://ipfs.zh-cn.help/images/social-card.png">
    <meta name="twitter:title" content="Using window.ipfs">
    <meta name="twitter:description" content="Learn about exposing IPFS API in IPFS Companion via " window.ipfs&#x22;.&#x22;="">
    <meta name="twitter:url" content="https://ipfs.zh-cn.help/how-to/companion-window-ipfs/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://ipfs.zh-cn.help/images/social-card.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data2" content="IPFS Team">
    <meta name="twitter:creator" content="@ipfsbot">
    <meta name="twitter:site" content="@ipfsbot">
    <meta name="image" content="https://ipfs.zh-cn.help/images/social-card.png">
    <meta name="keywords" content="IPFS, dweb, protocol, libp2p, ipld, multiformats, bitswap, decentralized web, InterPlanetary File System, dapp, documentation, docs, Protocol Labs">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="msapplication-config" content="/browserconfig.xml">
    <meta name="theme-color" content="#5bbad5">
    <link rel="preload" href="../../assets/css/0.styles.48421a0c.css" as="style"><link rel="preload" href="../../assets/js/app.dd338026.js" as="script"><link rel="preload" href="../../assets/js/3.80844059.js" as="script"><link rel="preload" href="../../assets/js/4.c442616c.js" as="script"><link rel="preload" href="../../assets/js/11.95efdf42.js" as="script"><link rel="prefetch" href="../../assets/js/10.dfca15a8.js"><link rel="prefetch" href="../../assets/js/12.07839899.js"><link rel="prefetch" href="../../assets/js/13.6cf6c4a8.js"><link rel="prefetch" href="../../assets/js/14.1c93464d.js"><link rel="prefetch" href="../../assets/js/15.ca1c5805.js"><link rel="prefetch" href="../../assets/js/16.e5e960f0.js"><link rel="prefetch" href="../../assets/js/17.da80b1c4.js"><link rel="prefetch" href="../../assets/js/18.2b7e83bc.js"><link rel="prefetch" href="../../assets/js/19.b87baf9e.js"><link rel="prefetch" href="../../assets/js/20.cdc617a4.js"><link rel="prefetch" href="../../assets/js/21.3517cfc6.js"><link rel="prefetch" href="../../assets/js/22.865ac29c.js"><link rel="prefetch" href="../../assets/js/23.d93e1abc.js"><link rel="prefetch" href="../../assets/js/24.765d7f56.js"><link rel="prefetch" href="../../assets/js/25.e24fb708.js"><link rel="prefetch" href="../../assets/js/26.70427fac.js"><link rel="prefetch" href="../../assets/js/27.85d51bd4.js"><link rel="prefetch" href="../../assets/js/28.0ccc2f23.js"><link rel="prefetch" href="../../assets/js/29.5f138771.js"><link rel="prefetch" href="../../assets/js/30.4e8d8ac5.js"><link rel="prefetch" href="../../assets/js/31.a1b736f8.js"><link rel="prefetch" href="../../assets/js/32.c7079282.js"><link rel="prefetch" href="../../assets/js/33.3434f567.js"><link rel="prefetch" href="../../assets/js/34.1241ff3c.js"><link rel="prefetch" href="../../assets/js/35.3b3c87c5.js"><link rel="prefetch" href="../../assets/js/36.b9e3b5e9.js"><link rel="prefetch" href="../../assets/js/37.f7328b2c.js"><link rel="prefetch" href="../../assets/js/38.28625f39.js"><link rel="prefetch" href="../../assets/js/39.a8987aeb.js"><link rel="prefetch" href="../../assets/js/40.d0fe89f1.js"><link rel="prefetch" href="../../assets/js/41.f951afd4.js"><link rel="prefetch" href="../../assets/js/42.3026d3bb.js"><link rel="prefetch" href="../../assets/js/43.b23d27bf.js"><link rel="prefetch" href="../../assets/js/44.c391375a.js"><link rel="prefetch" href="../../assets/js/45.40b7a764.js"><link rel="prefetch" href="../../assets/js/46.753df517.js"><link rel="prefetch" href="../../assets/js/47.c5f13b2f.js"><link rel="prefetch" href="../../assets/js/48.21ddb8ae.js"><link rel="prefetch" href="../../assets/js/49.312083c3.js"><link rel="prefetch" href="../../assets/js/5.e1cb8405.js"><link rel="prefetch" href="../../assets/js/50.71bcaa65.js"><link rel="prefetch" href="../../assets/js/51.749d314e.js"><link rel="prefetch" href="../../assets/js/52.564622f4.js"><link rel="prefetch" href="../../assets/js/53.86a9ab6e.js"><link rel="prefetch" href="../../assets/js/54.344ded92.js"><link rel="prefetch" href="../../assets/js/55.97f80e52.js"><link rel="prefetch" href="../../assets/js/56.c2f60432.js"><link rel="prefetch" href="../../assets/js/57.65cbe9fa.js"><link rel="prefetch" href="../../assets/js/58.0d06ad85.js"><link rel="prefetch" href="../../assets/js/59.5d468439.js"><link rel="prefetch" href="../../assets/js/6.d7dbdc46.js"><link rel="prefetch" href="../../assets/js/60.70a111ca.js"><link rel="prefetch" href="../../assets/js/61.7450bf16.js"><link rel="prefetch" href="../../assets/js/62.bda4ddd0.js"><link rel="prefetch" href="../../assets/js/63.ffdd7aa4.js"><link rel="prefetch" href="../../assets/js/64.4b255cd6.js"><link rel="prefetch" href="../../assets/js/65.ef4e1985.js"><link rel="prefetch" href="../../assets/js/66.92ff51c8.js"><link rel="prefetch" href="../../assets/js/67.8771b86e.js"><link rel="prefetch" href="../../assets/js/68.948f44e5.js"><link rel="prefetch" href="../../assets/js/69.91d13430.js"><link rel="prefetch" href="../../assets/js/7.ec67fb59.js"><link rel="prefetch" href="../../assets/js/70.37377fc7.js"><link rel="prefetch" href="../../assets/js/71.cb7ded42.js"><link rel="prefetch" href="../../assets/js/72.6dad3d13.js"><link rel="prefetch" href="../../assets/js/73.ea6ed6ae.js"><link rel="prefetch" href="../../assets/js/74.c1706da6.js"><link rel="prefetch" href="../../assets/js/75.a9d4dbd6.js"><link rel="prefetch" href="../../assets/js/8.e4afc831.js"><link rel="prefetch" href="../../assets/js/9.ceda3220.js"><link rel="prefetch" href="../../assets/js/vendors~docsearch.149cd94a.js">
    <link rel="stylesheet" href="../../assets/css/0.styles.48421a0c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="../../images/ipfs-logo.svg" alt="IPFS Docs" class="logo"> <span class="site-name can-hide">IPFS Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="../../how-to/companion-window-ipfs/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="../../zh-Hans/" class="nav-link">
  中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="../../how-to/companion-window-ipfs/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="../../zh-Hans/" class="nav-link">
  中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="../../install/" class="sidebar-heading clickable"><span>Install</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="../../recent-releases/" class="sidebar-heading clickable"><span>Recent releases</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="../../concepts/" class="sidebar-heading clickable"><span>Concepts</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="../../how-to/" class="sidebar-heading clickable router-link-active open"><span>How-tos</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Quick start</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../../how-to/command-line-quick-start/" class="sidebar-link">Command-line quick start</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Customize your install</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../../how-to/configure-node/" class="sidebar-link">Configure a node</a></li><li><a href="../../how-to/modify-bootstrap-list/" class="sidebar-link">Modify the bootstrap list</a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/custom-ipfs-repo" target="_blank" rel="noopener noreferrer" class="sidebar-link">Customize an IPFS repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Manage files</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/ipfs-101" target="_blank" rel="noopener noreferrer" class="sidebar-link">Use js-ipfs as a library<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/ipfs/go-ipfs/tree/master/docs/examples/go-ipfs-as-a-library/README.md" target="_blank" rel="noopener noreferrer" class="sidebar-link">Use go-ipfs as a library<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="../../how-to/work-with-blocks/" class="sidebar-link">Work with blocks</a></li><li><a href="../../how-to/pin-files/" class="sidebar-link">Pin files</a></li><li><a href="https://github.com/ipfs/go-ipfs/blob/master/docs/file-transfer.md" target="_blank" rel="noopener noreferrer" class="sidebar-link">Troubleshoot file transfers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/traverse-ipld-graphs" target="_blank" rel="noopener noreferrer" class="sidebar-link">Traverse IPLD graphs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="../../how-to/take-snapshot/" class="sidebar-link">Take a snapshot</a></li><li><a href="../../how-to/store-play-videos/" class="sidebar-link">Store &#x26; play videos</a></li><li><a href="../../how-to/host-git-style-repo/" class="sidebar-link">Host a Git-style repo</a></li><li><a href="https://github.com/ipfs/archives/tree/master/tutorials/replicating-large-datasets" target="_blank" rel="noopener noreferrer" class="sidebar-link">Replicate large datasets<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="../../how-to/move-ipfs-installation/" class="sidebar-link">Move an IPFS installation</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Work with peers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../../how-to/observe-peers/" class="sidebar-link">Observe peers</a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/custom-libp2p" target="_blank" rel="noopener noreferrer" class="sidebar-link">Customize libp2p bundles<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/circuit-relaying" target="_blank" rel="noopener noreferrer" class="sidebar-link">Use circuit relay<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Host websites</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../../how-to/host-single-page-site/" class="sidebar-link">Host a single-page site</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Work with blockchains</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/explore-ethereum-blockchain" target="_blank" rel="noopener noreferrer" class="sidebar-link">Explore the Ethereum chain<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Build apps</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../../how-to/make-service/" class="sidebar-link">Make a service</a></li><li><a href="https://github.com/ipfs/camp/tree/master/CORE_AND_ELECTIVE_COURSES/CORE_COURSE_C" target="_blank" rel="noopener noreferrer" class="sidebar-link">Build with the IPFS API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/ipfs/camp/tree/master/CORE_AND_ELECTIVE_COURSES/CORE_COURSE_B" target="_blank" rel="noopener noreferrer" class="sidebar-link">Make a basic libp2p app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>IPFS in the browser</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../../how-to/address-ipfs-on-web/" class="sidebar-link">Address IPFS on the Web</a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/exchange-files-in-browser" target="_blank" rel="noopener noreferrer" class="sidebar-link">Exchange files between nodes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/browser-mfs" target="_blank" rel="noopener noreferrer" class="sidebar-link">Use MFS in the browser<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/browser-add-readable-stream" target="_blank" rel="noopener noreferrer" class="sidebar-link">Add directories using streams<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.youtube.com/watch?v=Nv_Teb--1zg" target="_blank" rel="noopener noreferrer" class="sidebar-link">Make a pubsub room<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.youtube.com/watch?v=-kdx8rJd8rQ" target="_blank" rel="noopener noreferrer" class="sidebar-link">Edit collaboratively with CRDT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/browser-readablestream" target="_blank" rel="noopener noreferrer" class="sidebar-link">Stream video<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="../../how-to/browser-tools-frameworks/" class="sidebar-link">Browser tools and frameworks</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>IPFS Companion</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="../../how-to/companion-node-types/" class="sidebar-link">Node types</a></li><li><a href="../../how-to/dnslink-companion/" class="sidebar-link">DNSLink support</a></li><li><a href="../../how-to/companion-window-ipfs/" aria-current="page" class="active sidebar-link">Using window.ipfs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="../../how-to/companion-window-ipfs/#window-ipfs-is-currently-disabled" class="sidebar-link">window.ipfs is currently disabled</a></li><li class="sidebar-sub-header"><a href="../../how-to/companion-window-ipfs/#background" class="sidebar-link">Background</a></li><li class="sidebar-sub-header"><a href="../../how-to/companion-window-ipfs/#creating-applications-using-window-ipfs" class="sidebar-link">Creating applications using window.ipfs</a></li><li class="sidebar-sub-header"><a href="../../how-to/companion-window-ipfs/#q-a" class="sidebar-link">Q&#x26;A</a></li></ul></li><li><a href="../../how-to/companion-x-ipfs-path-header/" class="sidebar-link">Using x-ipfs-path</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="../../reference/" class="sidebar-heading clickable"><span>API &#x26; CLI</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="../../community/" class="sidebar-heading clickable"><span>Community</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="../../project/" class="sidebar-heading clickable"><span>Project</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page" data-v-4d32535d=""> <div class="theme-default-content content__default" data-v-4d32535d=""><h1 id="using-window-ipfs-in-ipfs-companion"><a href="#using-window-ipfs-in-ipfs-companion" class="header-anchor">#</a> Using <code>window.ipfs</code> in IPFS Companion</h1> <p>Learn about exposing IPFS API in IPFS Companion via "window.ipfs".</p> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <h2 id="window-ipfs-is-currently-disabled"><a href="#window-ipfs-is-currently-disabled" class="header-anchor">#</a> <code>window.ipfs</code> is currently disabled</h2> <p>IPFS Companion 2.11 stopped injecting <code>window.ipfs</code>. It will be restored after the <a href="https://github.com/ipfs-shipyard/ipfs-companion/issues/843" target="_blank" rel="noopener noreferrer">move to JS API with async await and async iterables<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, with a likely ETA of Q3 2020. This page is provided for reference only.</p></div> <h2 id="background"><a href="#background" class="header-anchor">#</a> Background</h2> <p>IPFS Companion exposes a subset of IPFS APIs as <code>window.ipfs</code> on every webpage. This means websites can detect that <code>window.ipfs</code> already exists and use it instead of spawning their own <code>js-ipfs</code> node, which saves resources, battery, etc.</p> <p>For more context, see:</p> <ul><li>First iteration: <a href="https://github.com/ipfs-shipyard/ipfs-companion/issues/330" target="_blank" rel="noopener noreferrer">window.ipfs v1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Second iteration (currently under development): <a href="https://github.com/ipfs-shipyard/ipfs-companion/issues/589" target="_blank" rel="noopener noreferrer">window.ipfs v2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="creating-applications-using-window-ipfs"><a href="#creating-applications-using-window-ipfs" class="header-anchor">#</a> Creating applications using <code>window.ipfs</code></h2> <p>If a user has installed IPFS Companion, <code>window.ipfs</code> will be available as soon as the first script runs on your web page, so you'll be able to detect it using a simple <code>if</code> statement:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ipfs <span class="token operator">&#x26;&#x26;</span> window<span class="token punctuation">.</span>ipfs<span class="token punctuation">.</span>enable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ipfs <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span>ipfs<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">{</span> commands<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'dag'</span><span class="token punctuation">,</span> <span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> ipfs<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// Fallback</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To add and get content, you could update the above example to do something like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ipfs <span class="token operator">&#x26;&#x26;</span> window<span class="token punctuation">.</span>ipfs<span class="token punctuation">.</span>enable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ipfs <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">.</span>ipfs<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">{</span> commands<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> hash <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> ipfs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'=^.^='</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> ipfs<span class="token punctuation">.</span><span class="token function">cat</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// =^.^=</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'ERR_IPFS_PROXY_ACCESS_DENIED'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Proxy is present but user denied access.</span>
      <span class="token comment">// (fallback to js-ipfs or js-ipfs-http-client goes here)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Something else went wrong (error handling)</span>
      <span class="token keyword">throw</span> err
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// No IPFS Proxy</span>
  <span class="token comment">// (fallback to js-ipfs or js-ipfs-http-client goes here)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Use <a href="https://github.com/ipfs-shipyard/ipfs-provider" target="_blank" rel="noopener noreferrer">ipfs-provider<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to ensure your app follows any future changes of this interface. It reduces amount of code needed to implement a robust fallback to HTTP API or embedded js-ipfs when <code>window.ipfs</code> is not available.</p></div> <h3 id="error-codes"><a href="#error-codes" class="header-anchor">#</a> Error codes</h3> <p>Errors returned by IPFS proxy can be identified by the value of the <code>code</code> attribute.</p> <p><code>ERR_IPFS_PROXY_ACCESS_DENIED</code> is thrown when the current scope has no access rights to requested commands.</p> <p>Optional <code>scope</code> and <code>permissions</code> attributes provide detailed information:</p> <ul><li>If access was denied for a specific command, then the <code>permissions</code> list is present and includes names of blocked commands</li> <li>If the entire IPFS proxy was disabled by the user, then the <code>permissions</code> list is missing entirely</li></ul> <h2 id="q-a"><a href="#q-a" class="header-anchor">#</a> Q&#x26;A</h2> <h3 id="what-is-a-window-ipfs"><a href="#what-is-a-window-ipfs" class="header-anchor">#</a> What is a <code>window.ipfs</code>?</h3> <p>It is an IPFS proxy endpoint that enables you to obtain an IPFS API instance. Depending how IPFS Companion is configured, you may be talking directly to a <code>js-ipfs</code> node running in Companion, a <code>go-ipfs</code> daemon over <code>js-ipfs-http-client</code>, or a <code>js-ipfs</code> daemon over <code>js-ipfs-http-client</code> ... and potentially others in the future. Note that object returned by <code>window.ipfs.enable</code> is <em>not</em> an instance of <code>js-ipfs</code> or <code>js-ipfs-http-client</code>, but is a proxy to one of them, so don't expect to be able to detect either of them or be able to use any undocumented or instance-specific functions.</p> <p>For information on available functions, see the <a href="https://github.com/ipfs/js-ipfs" target="_blank" rel="noopener noreferrer">js-ipfs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://github.com/ipfs/js-ipfs-http-client" target="_blank" rel="noopener noreferrer">js-ipfs-http-client<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> docs for available functions. If you find that some new functions are missing, the proxy might be out of date. Please check the <a href="https://github.com/tableflip/ipfs-postmsg-proxy#current-status" target="_blank" rel="noopener noreferrer">current status<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and submit a PR.</p> <h3 id="how-do-i-fall-back-if-window-ipfs-is-not-available"><a href="#how-do-i-fall-back-if-window-ipfs-is-not-available" class="header-anchor">#</a> How do I fall back if <code>window.ipfs</code> is not available?</h3> <p>See the <a href="https://github.com/ipfs-shipyard/ipfs-companion/blob/master/examples/window.ipfs-fallback.html" target="_blank" rel="noopener noreferrer">example code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (and <a href="https://ipfs-shipyard.github.io/ipfs-companion/examples/window.ipfs-fallback.html" target="_blank" rel="noopener noreferrer">live demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) for getting an IPFS instance with a fallback.</p> <p><strong>Tip:</strong> Use the <a href="https://www.npmjs.com/package/window.ipfs-fallback" target="_blank" rel="noopener noreferrer">window.ipfs-fallback<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> library, which takes care of the fallback ceremony. It will ensure your app follows API changes and does not break in the future.</p> <h3 id="what-about-ipfs-node-configuration"><a href="#what-about-ipfs-node-configuration" class="header-anchor">#</a> What about IPFS node configuration?</h3> <p>Right now, access to the <code>config</code> command is blocked, and you can't make any assumptions about how the node is configured. For example, the user may not have enabled experimental features like PubSub.</p> <p>Spawn a dedicated js-ipfs instance if you need non-standard configuration or any experimental features.</p> <h3 id="is-there-a-permission-control-acl"><a href="#is-there-a-permission-control-acl" class="header-anchor">#</a> Is there a permission control (ACL)?</h3> <p>Yes. IPFS Companion users are able to selectively control access to proxied commands, so calls may reject (or callback) with <a href="#error-codes">an error</a> if a user decides to deny access. The first time you call a proxied function, the user will be prompted to allow or deny the call, and the decision will be remembered for subsequent calls. Here's what it looks like:</p> <p><img src="../../assets/img/companion-permissions.58520b79.png" alt="single permission dialog in Firefox" width="740" height="463" loading="lazy"></p> <h3 id="do-i-need-to-confirm-every-api-call"><a href="#do-i-need-to-confirm-every-api-call" class="header-anchor">#</a> Do I need to confirm every API call?</h3> <p>Command access needs to be confirmed only once <a href="#how-are-permissions-scoped">per scope</a>. If you provide a list of commands when requesting an API instance via <code>window.ipfs.enable({commands})</code>, then a single permission dialog will be displayed to the user:</p> <p><img src="../../assets/img/companion-permissions-bulk.32c50809.png" alt="bulk permission dialog in Firefox" width="740" height="460" loading="lazy"></p> <p>For everything else, only the first call requires a decision from the user. You will be able to call previously whitelisted IPFS commands and users will <em>not</em> be prompted to allow/deny access the second time.</p> <p>Note that users can modify their permission decisions after the fact, so you should not expect to always be allowed to call a command if it was successfully called previously.</p> <h3 id="can-i-disable-this"><a href="#can-i-disable-this" class="header-anchor">#</a> Can I disable this?</h3> <p>Users can permanently deny access to all IPFS commands by disabling the <code>window.ipfs</code> experiment IPFS Companion's preferences.</p> <h3 id="how-are-permissions-scoped"><a href="#how-are-permissions-scoped" class="header-anchor">#</a> How are permissions scoped?</h3> <p>Permissions are scoped to the <strong>origin and path</strong> (and sub-paths) of the file from which the permission was requested.</p> <p>Scoped permissions in <code>window.ipfs</code> work similarly to how they work for <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/register#Examples" target="_blank" rel="noopener noreferrer">service worker registrations<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, except that the user cannot control the scope, and it is set to the origin and path from which the permission was requested.</p> <p>Scope-based permissions allow applications running on an IPFS gateway to be granted different permissions. Consider the following two websites running on the ipfs.io gateway:</p> <ul><li><a href="https://ipfs.io/ipfs/QmQxeMcbqW9npq5h5kyE2iPECR9jxJF4j5x4bSRQ2phLY4/" target="_blank" rel="noopener noreferrer">QmQxeMcbqW9npq5h5kyE2iPECR9jxJF4j5x4bSRQ2phLY4<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://ipfs.io/ipfs/QmTegrragyzfFq6DSuUaPYoKzm4eRBj2tgQaDHC72dLLaV/" target="_blank" rel="noopener noreferrer">QmTegrragyzfFq6DSuUaPYoKzm4eRBj2tgQaDHC72dLLaV<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>With <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener noreferrer">same-origin policy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, these two applications would be granted the same permissions. With scoped permissions, these applications will be given a different set of permissions. For example:</p> <ul><li>Allow <code>files.add</code> to <code>https://domain.com/</code> <ul><li>...will allow <code>files.add</code> to:
<ul><li><code>https://domain.com/file</code></li> <li><code>https://domain.com/file2.html</code></li> <li><code>https://domain.com/sub/paths</code></li> <li><code>https://domain.com/sub/paths/files</code></li> <li>etc.</li></ul></li></ul></li> <li>Allow <code>files.add</code> to <code>https://domain.com/feature</code> <ul><li>...will allow <code>files.add</code> to:
<ul><li><code>https://domain.com/feature/file</code></li> <li><code>https://domain.com/feature/file2.html</code></li> <li><code>https://domain.com/feature/sub/paths</code></li> <li><code>https://domain.com/feature/sub/paths/files</code></li> <li><code>https://domain.com/featuresearch/sub/paths/files</code> (note substring)</li> <li><code>https://domain.com/features.html</code> (note substring)</li> <li>etc.</li></ul></li> <li>...will cause additional prompt for <code>files.add</code> to:
<ul><li><code>https://domain.com/</code></li> <li><code>https://domain.com/files</code></li> <li>etc.</li></ul></li></ul></li></ul> <h3 id="are-mutable-file-system-mfs-files-sandboxed-to-a-directory"><a href="#are-mutable-file-system-mfs-files-sandboxed-to-a-directory" class="header-anchor">#</a> Are Mutable File System (MFS) files sandboxed to a directory?</h3> <p>Yes. To avoid conflicts, each app gets its own MFS directory where it can store files. When using MFS commands (<a href="https://github.com/ipfs/interface-ipfs-core/blob/master/SPEC/FILES.md#mutable-file-system" target="_blank" rel="noopener noreferrer">more info<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>), this directory will be automatically added to paths you pass. Your app's MFS directory is based on the <strong>origin and path</strong> where your application is running. For example:</p> <ul><li><code>files.write</code> to <code>/myfile.txt</code> on <code>https://domain.com/</code> <ul><li>writes to <code>/dapps/https/domain.com/myfile.txt</code></li></ul></li> <li><code>files.write</code> to <code>/path/to/myfile.txt</code> on <code>https://domain.com/feature</code> <ul><li>writes to <code>/dapps/https/domain.com/feature/path/to/myfile.txt</code></li></ul></li> <li><code>files.read</code> from <code>/feature/path/to/myfile.txt</code> on <code>https://domain.com/</code> <ul><li>reads from <code>/dapps/https/domain.com/feature/path/to/myfile.txt</code></li></ul></li> <li><code>files.stat</code> to <code>/</code> on <code>https://domain.com/feature</code> <ul><li>stats <code>/dapps/https/domain.com/feature</code></li></ul></li> <li><code>files.read</code> from <code>/../myfile.txt</code> on <code>https://domain.com/feature</code> <ul><li>reads from <code>/dapps/https/domain.com/feature/myfile.txt</code> (no traverse above your app's root)</li></ul></li></ul></div> <div class="content-footer" data-v-4d32535d=""><div class="feedback content-feedback" data-v-5f530d7b="" data-v-4d32535d=""><h3 data-v-5f530d7b="">Was this information helpful?</h3> <div class="feedback-actions" data-v-5f530d7b=""><button title="Yes" class="btn btn-primary" data-v-5f530d7b="">
      Yes
    </button> <button title="No" class="btn btn-primary" data-v-5f530d7b="">
      No
    </button></div> <!----> <div class="feedback-edit-or-issue" data-v-5f530d7b=""><div class="local-page-edit" data-v-5f530d7b=""><div class="local-edit-link"><a href="https://github.com/ipfs/ipfs-docs/edit/master/docs/how-to/companion-window-ipfs.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span>
      on GitHub or
      <a href="https://github.com/ipfs/ipfs-docs/issues/new?assignees=&#x26;labels=need%2Ftriage&#x26;template=open_an_issue.md&#x26;title=Using window.ipfs" target="_blank" rel="noopener noreferrer">open an issue</a></span></div></div></div></div> <div class="legacy-callout" data-v-00666086="" data-v-4d32535d=""><p data-v-00666086=""><b data-v-00666086="">Help us improve this site!</b></p> <section data-v-00666086=""><div class="block" data-v-00666086=""><ul data-v-00666086=""><li data-v-00666086=""><a href="https://github.com/ipfs/ipfs-docs/issues/new?assignees=&#x26;labels=OKR+3%3A+Content+Improvement%2C+docs-ipfs&#x26;template=content-request.md&#x26;title=%5BCONTENT+REQUEST%5D+%28add+your+title+here%21%29" target="_blank" rel="noopener noreferrer" data-v-00666086="">Suggest new content</a></li> <li data-v-00666086=""><a href="https://ipfs.canny.io/docs-features" target="_blank" rel="noopener noreferrer" data-v-00666086="">Request features</a></li></ul></div> <div class="block" data-v-00666086=""><ul data-v-00666086=""><li data-v-00666086=""><a href="https://github.com/ipfs/ipfs-docs/issues/new?assignees=&#x26;labels=OKR+3%3A+Content+Improvement%2C+docs-ipfs&#x26;template=documentation-issue.md&#x26;title=%5BDOCS+ISSUE%5D+%28add+your+title+here%21%29" target="_blank" rel="noopener noreferrer" data-v-00666086="">Give general feedback</a></li></ul></div></section></div> <footer class="page-edit" data-v-4d32535d=""><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/23/2020, 3:25:51 AM</span></div></footer> <!----></div> <div data-v-4d32535d=""></div> <div data-v-4d32535d=""></div> </main></div><div class="global-ui"><!----><div></div></div></div>
    <script src="../../assets/js/app.dd338026.js" defer></script><script src="../../assets/js/3.80844059.js" defer></script><script src="../../assets/js/4.c442616c.js" defer></script><script src="../../assets/js/11.95efdf42.js" defer></script>
  

</body></html>